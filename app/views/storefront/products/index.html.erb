<h1>Our Products</h1>

<!-- Category Filter Form -->
<div class="filter">
  <%= form_with url: storefront_products_path, method: :get, local: true do %>
    <label for="category_id"><strong>Filter by Category:</strong></label>
    <%= select_tag :category_id,
          options_from_collection_for_select(@categories, :id, :name, @selected_category),
          include_blank: "All Categories",
          onchange: "this.form.submit();" %>
  <% end %>
</div>

<!-- Product List -->
<div class="products">
  <% @products.each do |product| %>
    <div class="product">
      <%= image_tag product.image, size: "150x150" if product.image.attached? %>
      <h3><%= link_to product.name, storefront_product_path(product) %></h3>
      <p><%= product.description.truncate(100) %></p>
      <p><strong>Price:</strong> $<%= product.price %></p>
    </div>
  <% end %>
</div>

<!-- Pagination Links -->
<div class="pagination">
  <%= paginate @products %>
</div>
